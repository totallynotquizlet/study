<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Match | Totally Not Quizlet</title>
    
    <!-- Shared Styles -->
    <link rel="stylesheet" href="../Shared/base.css">
    <link rel="stylesheet" href="../Shared/ui.css">
    <!-- Mode Specific Styles -->
    <link rel="stylesheet" href="style.css">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="../favicon.png">
    
    <!-- Tailwind (Utility classes used in legacy files) -->
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>

    <div id="app-container" class="max-w-4xl mx-auto p-4 md:p-8 min-h-screen relative flex flex-col">
        
        <!-- Absolute Header Elements (Settings, Theme, Logo) -->
        <!-- Note: Settings button starts hidden until deck is loaded -->
        <button id="settings-button" class="absolute top-6 left-6 md:top-8 md:left-10 z-50 p-2 rounded-full transition-all duration-300 hidden">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
        </button>

        <button id="theme-toggle-button" class="absolute top-6 right-6 md:top-8 md:right-10 z-50 p-2 rounded-full transition-all duration-300">
            <span id="theme-icon-sun" class="text-3xl" style="line-height: 1;">â˜¼</span>
            <svg id="theme-icon-moon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
        </button>

        <img src="../favicon.png" alt="Site Logo" id="header-logo" class="absolute top-6 md:top-8 left-1/2 -translate-x-1/2 z-50">

        <header class="mb-6 pt-20">
            <h1 id="header-title" class="text-3xl text-center mb-6">Match</h1>
            <nav class="flex justify-center p-2 space-x-1 md:space-x-2">
                <!-- Navigation injected by Shared/nav.js -->
            </nav>
        </header>

        <main id="main-content" class="flex-grow">

            <!-- Match View Container -->
            <div id="match-view" class="app-view">
                
                <!-- State: Disabled (Not enough cards) -->
                <div id="match-mode-disabled" class="text-center p-8 md:p-12 rounded-lg hidden panel-container">
                    <h2 class="text-2xl font-semibold mb-4">Match Mode Needs More Cards</h2>
                    <p>This mode requires at least 2 cards in your deck. Please add more cards to get started.</p>
                </div>

                <!-- State: Start Screen (With Slider) -->
                <div id="match-start-screen" class="text-center p-8 md:p-12 rounded-lg panel-container">
                    <h2 class="text-2xl font-semibold mb-4">Match Game</h2>
                    <p class="mb-8">Find the matching terms and definitions as fast as you can!</p>
                    
                    <!-- REQUIRED CHANGE: Card Count Slider -->
                    <div class="mb-8 w-full max-w-xs mx-auto">
                        <div class="flex justify-between mb-2">
                            <label for="match-count-slider" class="font-bold text-[var(--color-text-secondary)]">Terms per round</label>
                            <span id="match-count-display" class="font-bold text-[var(--color-primary)]">10</span>
                        </div>
                        <input type="range" id="match-count-slider" min="2" max="20" step="1" value="10" 
                               class="w-full h-2 bg-[var(--color-card-bg)] rounded-lg appearance-none cursor-pointer border border-[var(--color-border)]">
                    </div>

                    <button id="match-start-button" class="main-action-button font-medium py-3 px-6 rounded-lg">
                        Start Game
                    </button>
                </div>

                <!-- State: Active Game -->
                <div id="match-mode-game" class="hidden">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-bold">Match the pairs!</h2>
                        <div class="text-right">
                            <div id="match-timer" class="text-2xl font-bold">0.0s</div>
                            <div id="match-best-time" class="text-sm">Best: --.-s</div>
                        </div>
                    </div>
                    <div id="match-game-area" class="grid grid-cols-2 gap-4">
                        <div id="match-terms-list" class="space-y-3">
                            <!-- Terms injected by script -->
                        </div>
                        <div id="match-defs-list" class="space-y-3">
                            <!-- Definitions injected by script -->
                        </div>
                    </div>
                </div>

                <!-- State: Complete -->
                <div id="match-complete-view" class="text-center p-8 md:p-12 rounded-lg hidden panel-container">
                    <h2 class="text-2xl font-semibold mb-4">You've matched them all!</h2>
                    <p class="mb-8">Great job! You've completed this set.</p>
                    <div class="flex flex-col md:flex-row gap-4 justify-center">
                        <button id="match-restart-button" class="main-action-button font-medium py-3 px-6 rounded-lg">
                            Play Again
                        </button>
                    </div>
                </div>
            </div>

        </main>

        <footer class="text-center p-6 mt-8 border-t">
            <p class="mb-2">Created by Jacob Nedell</p>
            <div class="flex justify-center space-x-4">
                <button id="about-button" class="footer-link underline cursor-pointer">About</button>
                <button id="keybinds-button" class="footer-link underline cursor-pointer">Keybinds</button>

                <a href="https://totallynotquizlet.github.io/memorize/" class="footer-link underline">
                    tnq memorize
                </a>
                
                <a href="https://forms.gle/aorM6MFQvaTMf16j9" class="footer-link underline" target="_blank" rel="noopener noreferrer">
                    Bug Report
                </a>
                
                <a href="https://forms.gle/Z1xESserXb1NVVDv6" class="footer-link underline" target="_blank" rel="noopener noreferrer">
                    Feature Request
                </a>
            </div>
        </footer>
        
        <div id="toast-notification" class="fixed bottom-6 right-6 py-3 px-5 rounded-lg shadow-xl opacity-0 translate-y-4 transition-all duration-300 z-50"></div>

    </div>

    <!-- Modals -->
    <!-- These rely on Shared/ui.css to be hidden by default (visibility: hidden; opacity: 0). -->
    <!-- Shared/nav.js (About/Keybinds) and match/script.js (Settings) toggle the .visible class. -->
    
    <!-- About Modal -->
    <div id="about-modal-overlay" class="modal-overlay fixed inset-0 z-50 flex items-center justify-center p-4">
        <div class="modal-backdrop fixed inset-0"></div>
        <div id="about-modal-content" class="relative w-full max-w-md p-6 md:p-8 rounded-2xl">
            <button id="about-modal-close" class="absolute top-4 right-5 text-3xl font-bold">&times;</button>
            <h2 class="text-2xl font-bold mb-4">About This Site</h2>
            <p>
                This study site was created to be an alternative to other options that bombard you 
                with ads or make you pay to use them. The site includes flashcards, multiple 
                choice questions, matching questions, and text questions with AI to intelligently help you memorize for school! With the 
                base64 URLs, you can share study sets you've created without having to create an 
                account and risk getting your personal information sold. Simply press the "Share 
                Deck" button in the top menu to instantly copy the link to your clipboard for fast 
                sharing. Your progress is stored locally in your browser and will not be deleted 
                unless you clear your history or site data. This site is still under works 
                and will contine to bring new features over time. Enjoy studying!
            </p>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal-overlay" class="modal-overlay fixed inset-0 z-50 flex items-center justify-center p-4">
        <div class="modal-backdrop fixed inset-0"></div>
        <div id="settings-modal-content" class="relative w-full max-w-md p-6 md:p-8 rounded-2xl space-y-6">
            <button id="settings-modal-close" class="absolute top-4 right-5 text-3xl font-bold">&times;</button>
            <h2 class="text-2xl font-bold mb-4">Study Set Options</h2>
            
            <div>
                <label for="setting-deck-title" class="create-label">DECK TITLE</label>
                <!-- Readonly because changing title changes hash, complex for this static view -->
                <input type="text" id="setting-deck-title" class="w-full" placeholder="Enter a title..." readonly>
            </div>
            <div>
                <label class="create-label">SHUFFLE CARDS</label>
                <button id="setting-toggle-shuffle" class="settings-toggle-button w-full">
                    Shuffle
                </button>
            </div>
            <!-- Start With is less relevant for Match but kept for UI consistency -->
            <div>
                <label class="create-label">START WITH</label>
                <button id="setting-toggle-start-with" class="settings-toggle-button w-full">
                    Term
                </button>
            </div>

            <div class="pt-4 border-t border-dashed border-[var(--color-border)]">
                <label class="create-label">EXPORT</label>
                <button id="copy-deck-button" class="secondary-action-button w-full">
                    Copy all terms and definitions
                </button>
            </div>
        </div>
    </div>

    <!-- Keybinds Modal -->
    <div id="keybinds-modal-overlay" class="modal-overlay fixed inset-0 z-50 flex items-center justify-center p-4">
        <div class="modal-backdrop fixed inset-0"></div>
        <div id="keybinds-modal-content" class="relative w-full max-w-lg p-6 md:p-8 rounded-2xl">
            <button id="keybinds-modal-close" class="absolute top-4 right-5 text-3xl font-bold">&times;</button>
            <h2 class="text-2xl font-bold mb-6">Keyboard Shortcuts</h2>
            <div class="space-y-6">
                <div>
                    <h3 class="text-lg font-semibold mb-2">Match Mode</h3>
                    <ul class="keybind-list">
                        <li><span class="italic">Click terms to match pairs. No keyboard shortcuts for this mode yet.</span></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../Shared/storage.js"></script>
    <script src="../Shared/nav.js"></script>
    <script src="script.js"></script>
</body>
</html>